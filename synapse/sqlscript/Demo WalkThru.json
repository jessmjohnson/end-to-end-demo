{
	"name": "Demo WalkThru",
	"properties": {
		"content": {
			"query": "\n SELECT TOP (100) * FROM [Telemetry].[vw_WorkloadOverview]\n\n SELECT TOP (100) * FROM Telemetry.Requests_Snapshot\n\n SELECT TOP (100) * FROM Telemetry.QS_Snapshot\n\n SELECT TOP (100) * FROM Telemetry.vw_PerformanceSnapshot;\n\n SELECT TOP (100) * FROM Telemetry.PlanDetails;  --save as .sqlplan\n\nSELECT TOP (100) * FROM Telemetry.vw_Troubleshoot_PipelineLog\n\n\n SELECT * FROM sys.query_store_query_text t\n JOIN sys.query_store_query q on q.query_text_id = t.query_text_id\n WHERE q.query_id = 4\n\n-- sys.query_store_plan\n\n\n-- then use these Query Store views to get stats + text + plan\nCREATE VIEW Telemetry.vw_QS_StatsTextPlan AS\nSELECT\n    i.start_time              AS ExecutionTime,\n    qt.query_sql_text         AS SqlText,\n    rs.avg_cpu_time           AS AvgCPU_ms,\n    rs.avg_duration           AS AvgDuration_ms,\n    rs.max_duration           AS MaxDuration_ms,\n    rs.count_executions       AS ExecutionCount,\n    p.query_plan              AS QueryPlanXml\nFROM sys.query_store_runtime_stats     AS rs\nJOIN sys.query_store_runtime_stats_interval AS i\n    ON rs.runtime_stats_interval_id = i.runtime_stats_interval_id\nJOIN sys.query_store_plan             AS p\n    ON rs.plan_id = p.plan_id\nJOIN sys.query_store_query            AS q\n    ON p.query_id = q.query_id\nJOIN sys.query_store_query_text       AS qt\n    ON q.query_text_id = qt.query_text_id\n-- optional: filter to recent executions\nWHERE i.start_time >= DATEADD(HOUR, -1, SYSUTCDATETIME())\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "dspendtoenddemo",
				"poolName": "dspendtoenddemo"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}