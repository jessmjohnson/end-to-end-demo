{
	"name": "Analytics-vw_MonAvgVisitDurByVisitorType",
	"properties": {
		"content": {
			"query": "\nCREATE VIEW Analytics.vw_MonAvgVisitDurByVisitorType AS\n-- Average visit length (minutes) per visitor type, by month\nSELECT\n  CONCAT(d.Year, '-', RIGHT('0' + CAST(d.MonthOfYear AS VARCHAR(2)),2)) AS [YearMonth],\n  vt.VisitorType          AS [Visitor Type],\n  ROUND(AVG(f.DurationMin), 1) AS [AvgDurationMin]\nFROM Gold.factVisitorLog AS f\nJOIN Gold.dimDate AS d\n  ON f.DateKey = d.DateKey\nJOIN Gold.dimVisitorType AS vt\n  ON f.VisitorTypeKey = vt.VisitorTypeKey\nGROUP BY\n  d.Year,\n  d.MonthOfYear,\n  vt.VisitorType\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "dspendtoenddemo",
				"poolName": "dspendtoenddemo"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}