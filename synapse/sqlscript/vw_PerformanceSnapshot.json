{
	"name": "vw_PerformanceSnapshot",
	"properties": {
		"content": {
			"query": "/****************************************************************************************\n * Script : vw_PerformanceSnapshot.sql\n * Schema : Telemetry\n * Purpose: Consolidates key performance metrics into a single snapshot view.\n * Author : Jess Johnson\n * Created: 2025-05-19\n * Version: 1.0\n *\n * Description: A consolidated “wide” view combining key metrics—resource-governor, \n *              request counts, slowest query, and CPU ms—into a single row per run-time slice.\n *\n * Why: Executives and engineers alike need a one-screen summary. This view surfaces multiple \n *      dimensions of performance in one place.\n *\n * Usage: Feed it into Power BI for dashboard tiles: request volume, CPU usage, and top query time.\n *\n * Benefits: Single pane of glass for performance health checks,\n *           Eases SLA reporting by aggregating metrics,\n *           Facilitates trend analysis across pipeline runs\n *\n * Dependencies:\n *   - Telemetry.Workload_Snapshot\n *   - Telemetry.Requests_Snapshot\n *   - Telemetry.QS_Snapshot\n *\n * Change History:\n * 2025-05-19 JJ-1.0 Initial creation\n ****************************************************************************************/\n\n-- ======================================================================================\n-- SECTION 1: Declarations\n-- ======================================================================================\n-- No parameters required.\n\n-- ======================================================================================\n-- SECTION 2: Main logic\n-- ======================================================================================\nCREATE VIEW Telemetry.vw_PerformanceSnapshot AS\nSELECT\n  W.PipelineName,\n  W.PipelineRunId,\n  W.CaptureTime,\n  W.PoolName,\n  W.WorkloadGroupName,\n  W.RunningRequests,\n  R.TotalRequests,\n  R.AvgElapsedMs       AS RequestAvgMs,\n  Q.MaxDuration        AS SlowestQueryUs,\n  W.ResourceMilliSeconds\nFROM Telemetry.vw_WorkloadOverview AS W\nLEFT JOIN Telemetry.vw_RequestStats      AS R\n  ON W.PipelineRunId = R.PipelineRunId\n AND W.CaptureTime   = R.CaptureTime\nLEFT JOIN (\n  SELECT PipelineRunId, CaptureTime, MaxDuration\n  FROM Telemetry.vw_QS_TopSlowQueries\n  WHERE RankByMaxDuration = 1\n) AS Q\n  ON W.PipelineRunId = Q.PipelineRunId\n AND W.CaptureTime   = Q.CaptureTime;\nGO\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "dspendtoenddemo",
				"poolName": "dspendtoenddemo"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}