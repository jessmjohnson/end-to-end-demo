{
	"name": "02_Create_Control_Asset_FileList",
	"properties": {
		"content": {
			"query": "/*****************************************************************************************/\n/** FileList                                                                            **/\n/**     What:   A table listing each source file with its date, target pipeline,        **/\n/**             status, and processing details.                                         **/\n/**                                                                                     **/\n/**     Why:    Enables metadataâ€‘driven ingestion by letting pipelines discover,        **/\n/**             track, and audit file processing.                                       **/\n/*****************************************************************************************/\n\n-------------------------------------------------------------------------------------------\n--  Table Design: Control.FileList \n-------------------------------------------------------------------------------------------\nCREATE TABLE Control.FileList\n(\n  FileListId      INT           IDENTITY(1,1) NOT NULL,\n  FileName        VARCHAR(260)  NOT NULL,\n  FileDate        DATE          NOT NULL,\n  PipelineName    VARCHAR(50)   NOT NULL,\n  Status          VARCHAR(20)   NOT NULL  DEFAULT('Pending'),\n  EnqueueTime     DATETIME2     NOT NULL,   -- populate via ADF parameter\n  StartTime       DATETIME2     NULL,\n  EndTime         DATETIME2     NULL,\n  RowsProcessed   BIGINT        NULL,\n  ErrorMessage    VARCHAR(2000) NULL\n)\nWITH\n(\n  DISTRIBUTION = HASH(FileDate)\n);\nGO\n\nALTER TABLE Control.FileList\nADD CONSTRAINT UQ_FileList_FileDateName\n  UNIQUE(FileDate, FileName, PipelineName) NOT ENFORCED;\nGO\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "dspendtoenddemo",
				"poolName": "dspendtoenddemo"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}