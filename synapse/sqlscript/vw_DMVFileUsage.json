{
	"name": "vw_DMVFileUsage",
	"properties": {
		"content": {
			"query": "/****************************************************************************************\n * Script : vw_DMVFileUsage.sql\n * Schema : Telemetry\n * Purpose: Provides file-level space usage metrics from Telemetry.DMV_Snapshot.\n * Author : Jess Johnson\n * Created: 2025-05-19\n * Version: 1.0\n *\n * Description: Shows per-file space usage (total, allocated, unallocated pages) for each \n *              node, captured over time.\n *\n * Why: Uneven data distribution or runaway file growth can cause skew or storage exhaustion. \n *      Monitoring file-space usage helps detect imbalance and manage capacity.\n *\n * Usage: Compare UnallocatedExtentPageCount vs. AllocatedExtentPageCount to gauge free space.\n *\n * Benefits: Detects skew when one nodeâ€™s files grow disproportionately.\n *           Capacity planning by tracking overall table growth,\n *           Maintenance triggers (e.g. repartition or reindex if skew > 20%)\n *\n * Dependencies:\n *   - Telemetry.DMV_Snapshot\n *\n * Change History:\n * 2025-05-19 JJ-1.0 Initial creation\n ****************************************************************************************/\n\n-- ======================================================================================\n-- SECTION 1: Declarations\n-- ======================================================================================\n-- No parameters required.\n\n-- ======================================================================================\n-- SECTION 2: Main logic\n-- ======================================================================================\nCREATE VIEW Telemetry.vw_DMVFileUsage AS\nSELECT\n  PipelineName,\n  PipelineRunId,\n  CaptureTime,\n  NodeID,\n  FileID,\n  TotalPageCount,\n  AllocatedExtentPageCount,\n  UnallocatedExtentPageCount\nFROM Telemetry.DMV_Snapshot;\nGO\n\n-- ======================================================================================\n-- SECTION 3: Cleanup / Reporting\n-- ======================================================================================\n-- No cleanup required.\nGO\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "dspendtoenddemo",
				"poolName": "dspendtoenddemo"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}